Index: .gitignore
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .gitignore	(date 1584994916824)
+++ .gitignore	(date 1584994916824)
@@ -0,0 +1,2 @@
+# Project exclude paths
+/out/
\ No newline at end of file
Index: .idea/.gitignore
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/.gitignore	(date 1584994916950)
+++ .idea/.gitignore	(date 1584994916950)
@@ -0,0 +1,2 @@
+# Default ignored files
+/workspace.xml
\ No newline at end of file
Index: .idea/modules.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/modules.xml	(date 1584980354873)
+++ .idea/modules.xml	(date 1584980354873)
@@ -0,0 +1,8 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="ProjectModuleManager">
+    <modules>
+      <module fileurl="file://$PROJECT_DIR$/bd.iml" filepath="$PROJECT_DIR$/bd.iml" />
+    </modules>
+  </component>
+</project>
\ No newline at end of file
Index: .idea/kotlinc.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/kotlinc.xml	(date 1584980354984)
+++ .idea/kotlinc.xml	(date 1584980354984)
@@ -0,0 +1,10 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="Kotlin2JvmCompilerArguments">
+    <option name="jvmTarget" value="1.8" />
+  </component>
+  <component name="KotlinCommonCompilerArguments">
+    <option name="apiVersion" value="1.3" />
+    <option name="languageVersion" value="1.3" />
+  </component>
+</project>
\ No newline at end of file
Index: .idea/misc.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/misc.xml	(date 1584980354740)
+++ .idea/misc.xml	(date 1584980354740)
@@ -0,0 +1,6 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="ProjectRootManager" version="2" languageLevel="JDK_11" default="true" project-jdk-name="11" project-jdk-type="JavaSDK">
+    <output url="file://$PROJECT_DIR$/out" />
+  </component>
+</project>
\ No newline at end of file
Index: .idea/codeStyles/codeStyleConfig.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/codeStyles/codeStyleConfig.xml	(date 1584980355454)
+++ .idea/codeStyles/codeStyleConfig.xml	(date 1584980355454)
@@ -0,0 +1,5 @@
+<component name="ProjectCodeStyleConfiguration">
+  <state>
+    <option name="USE_PER_PROJECT_SETTINGS" value="true" />
+  </state>
+</component>
\ No newline at end of file
Index: .idea/codeStyles/Project.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/codeStyles/Project.xml	(date 1584980355290)
+++ .idea/codeStyles/Project.xml	(date 1584980355290)
@@ -0,0 +1,10 @@
+<component name="ProjectCodeStyleConfiguration">
+  <code_scheme name="Project" version="173">
+    <JetCodeStyleSettings>
+      <option name="CODE_STYLE_DEFAULTS" value="KOTLIN_OFFICIAL" />
+    </JetCodeStyleSettings>
+    <codeStyleSettings language="kotlin">
+      <option name="CODE_STYLE_DEFAULTS" value="KOTLIN_OFFICIAL" />
+    </codeStyleSettings>
+  </code_scheme>
+</component>
\ No newline at end of file
Index: bd.iml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- bd.iml	(date 1584981408503)
+++ bd.iml	(date 1584981408503)
@@ -0,0 +1,13 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<module type="JAVA_MODULE" version="4">
+  <component name="NewModuleRootManager" inherit-compiler-output="true">
+    <exclude-output />
+    <content url="file://$MODULE_DIR$">
+      <sourceFolder url="file://$MODULE_DIR$/src" isTestSource="false" />
+    </content>
+    <orderEntry type="inheritedJdk" />
+    <orderEntry type="sourceFolder" forTests="false" />
+    <orderEntry type="library" name="KotlinJavaRuntime" level="project" />
+    <orderEntry type="library" name="mysql:mysql-connector-java:8.0.19" level="project" />
+  </component>
+</module>
\ No newline at end of file
Index: .idea/libraries/mysql_mysql_connector_java_8_0_19.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/libraries/mysql_mysql_connector_java_8_0_19.xml	(date 1584981408652)
+++ .idea/libraries/mysql_mysql_connector_java_8_0_19.xml	(date 1584981408652)
@@ -0,0 +1,11 @@
+<component name="libraryTable">
+  <library name="mysql:mysql-connector-java:8.0.19" type="repository">
+    <properties maven-id="mysql:mysql-connector-java:8.0.19" />
+    <CLASSES>
+      <root url="jar://$MAVEN_REPOSITORY$/mysql/mysql-connector-java/8.0.19/mysql-connector-java-8.0.19.jar!/" />
+      <root url="jar://$MAVEN_REPOSITORY$/com/google/protobuf/protobuf-java/3.6.1/protobuf-java-3.6.1.jar!/" />
+    </CLASSES>
+    <JAVADOC />
+    <SOURCES />
+  </library>
+</component>
\ No newline at end of file
Index: .idea/libraries/KotlinJavaRuntime.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/libraries/KotlinJavaRuntime.xml	(date 1584980355588)
+++ .idea/libraries/KotlinJavaRuntime.xml	(date 1584980355588)
@@ -0,0 +1,19 @@
+<component name="libraryTable">
+  <library name="KotlinJavaRuntime">
+    <CLASSES>
+      <root url="jar://$KOTLIN_BUNDLED$/lib/kotlin-stdlib.jar!/" />
+      <root url="jar://$KOTLIN_BUNDLED$/lib/kotlin-reflect.jar!/" />
+      <root url="jar://$KOTLIN_BUNDLED$/lib/kotlin-test.jar!/" />
+      <root url="jar://$KOTLIN_BUNDLED$/lib/kotlin-stdlib-jdk7.jar!/" />
+      <root url="jar://$KOTLIN_BUNDLED$/lib/kotlin-stdlib-jdk8.jar!/" />
+    </CLASSES>
+    <JAVADOC />
+    <SOURCES>
+      <root url="jar://$KOTLIN_BUNDLED$/lib/kotlin-stdlib-sources.jar!/" />
+      <root url="jar://$KOTLIN_BUNDLED$/lib/kotlin-reflect-sources.jar!/" />
+      <root url="jar://$KOTLIN_BUNDLED$/lib/kotlin-test-sources.jar!/" />
+      <root url="jar://$KOTLIN_BUNDLED$/lib/kotlin-stdlib-jdk7-sources.jar!/" />
+      <root url="jar://$KOTLIN_BUNDLED$/lib/kotlin-stdlib-jdk8-sources.jar!/" />
+    </SOURCES>
+  </library>
+</component>
\ No newline at end of file
Index: mark.csv
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- mark.csv	(date 1584991736957)
+++ mark.csv	(date 1584991736957)
@@ -0,0 +1,1 @@
+stud_id;subj_id;mark
\ No newline at end of file
Index: subject.csv
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- subject.csv	(date 1584992361687)
+++ subject.csv	(date 1584992361687)
@@ -0,0 +1,9 @@
+name;semester;control;hours
+Иностранный язык;1;Зачет;108
+Математический анализ;2;Экзамен;144
+Дифференциальные уравнения;3;Зачет;72
+Компьютерные технологии;4;Экзамен;72
+Экономика;5;Зачет;72
+Экстремальные задачи;6;Экзамен;118
+Философия;7;Зачет;72
+Политология;8;Зачет;72
Index: student.csv
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- student.csv	(date 1584992361639)
+++ student.csv	(date 1584992361639)
@@ -0,0 +1,8 @@
+surname;name;patronymic;group_num;birth;start_date
+Зайнуллина;Альбина;Ренатовна;05-501;1996-01-05;2015
+Громова;Дарья;Вячеславовна;05-703;1999-01-14;2017
+Хусаинова;Лилия;Рамзисовна;05-703;1999-09-24;2017
+Шеклеин;Николай;Андреевич;05-603;1998-06-21;2016
+Саитов;Руслан;Асланбекович;05-602;1998-12-14;2016
+Кенжаева;Дана;Ринатовна;05-801;2000-05-25;2018
+Киреева;Элиза;Галимовна;05-804;2000-05-11;2018
\ No newline at end of file
Index: src/Main.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/Main.kt	(date 1584993901255)
+++ src/Main.kt	(date 1584993901255)
@@ -0,0 +1,119 @@
+import java.io.BufferedReader
+import java.io.FileInputStream
+import java.io.InputStreamReader
+import java.sql.Connection
+import java.sql.DriverManager
+import java.sql.Statement
+import java.util.*
+
+fun main() {
+    val c: Connection = DriverManager.getConnection(
+        "jdbc:mysql://localhost:3306/test?serverTimezone=UTC",
+        "dargr",
+        "14011"
+    )
+    val s: Statement = c.createStatement()
+
+    val dt1 = "drop table if exists `student`"
+    val dt2 = "drop table if exists `subject`"
+    val dt3 = "drop table if exists `mark`"
+    s.execute(dt3)
+    s.execute(dt1) //выполнить
+    s.execute(dt2)
+
+    val ct1: String = "create table if not exists `student` (" +
+            "id int auto_increment primary key, " +
+            "name varchar(30) not null, " +
+            "surname varchar(30) not null, " +
+            "patronymic varchar(30), " +
+            "group_num varchar(6) not null, " +
+            "birth date not null, " +
+            "start_date year not null" +
+            ");"
+    val ct2: String = "create table if not exists `subject` ("+
+            "id int auto_increment primary key, "+
+            "name varchar(30) not null, "+
+            "semester int not null, "+
+            "control enum('Зачет', 'Диф.зачет', 'Экзамен') not null, "+
+            "hours int not null "+
+            ");"
+
+    val ct3: String = "create table if not exists `mark` (" +
+            "id int auto_increment primary key, " +
+            "stud_id int not null, " +
+            "subj_id int not null, " +
+            "mark int not null, " +
+            "constraint `stud` foreign key (`stud_id`) references `student` (`id`) , " +
+            "constraint `subj` foreign key (`subj_id`) references `subject` (`id`) " +
+            ");"
+    s.execute(ct1)
+    s.execute(ct2)
+    s.execute(ct3)
+
+    val files: List<String> = listOf("student.csv", "subject.csv")
+    for (f: String in files) {
+        val br = BufferedReader(
+            InputStreamReader(
+                FileInputStream(f)
+            )
+        )
+        val tb1 = f.split(".")[0]
+        var first = true
+        var cols = listOf<String>()
+        while (br.ready()) {
+            val l = br.readLine()
+            if (first && l != null) {
+                first = false
+                cols = l.split(";")
+                continue
+            }
+            if (l != null) {
+                val vals = l.split(";")
+                var q = "INSERT INTO `$tb1` ("
+                for (i in 0 until cols.size) {
+                    q += "`${cols[i]}`"
+                    if (i < cols.size - 1) q += ", "
+                }
+                q += ") VALUES ("
+                for (i in 0 until vals.size) {
+                    q += "'${vals[i]}'"
+                    if (i < vals.size - 1) q += ", "
+                }
+                q += ");"
+                s.execute(q)
+            } else break
+        }
+    }
+
+    //Список студенов определенной группы
+    val sc = Scanner(System.`in`)
+    val group_num = sc.next()
+    val sq1 = "SELECT name,surname,patronymic " +
+            "FROM `student` " +
+            "WHERE group_num='$group_num' " +
+            "ORDER BY surname, name, patronymic;"
+    val result = s.executeQuery(sq1)
+    while (result.next()) {
+        print(result.getString("surname"))
+        print(" ")
+        print(result.getString("name"))
+        print(" ")
+        print(result.getString("patronymic"))
+        println()
+    }
+}
+
+
+    /*var groupNum = Scanner(System.`in`).next()
+    var SQLrequest = "SELECT * FROM `students` WHERE `Student_group` ='$groupNum'"
+    val result = s.executeQuery(SQLrequest)
+    while (result.next()){
+        print(result.getString("SURNAME"))
+        print(" ")
+        print(result.getString("NAME"))
+        print(" ")
+        print(result.getString("FATHERNAME"))
+        println()
+    }
+    println()*/
+
